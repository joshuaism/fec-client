<div class="container">
  <div class="row">
    <div class="col-5">
      <span><b>Contributor Information</b></span>
      <app-multi-text label="Name" max="10" [elements]="names"></app-multi-text>
      <app-multi-text label="Employer" max="10" [elements]="employers"></app-multi-text>
      <app-multi-text label="Occupation" max="10" [elements]="occupations"></app-multi-text>
      <app-multi-text label="City" max="10" [elements]="cities"></app-multi-text>
      <app-us-states [state]="state" (selection)="setState($event)"></app-us-states>
    </div>
    <div class="col">
      <span><b>Committee Type</b></span><br/>
      <div *ngFor="let checkbox of committeeTypeMap | keyvalue: originalOrder">
        <input type="checkbox" id="{{checkbox.key}}" [ngModel]="committeeTypeMap.get(checkbox.key)"
          (ngModelChange)="committeeTypeMap.set(checkbox.key, $event)">
        <label for={{checkbox.key}}>{{checkbox.key}}</label>
      </div>
    </div>
    <div class="col">
      <span><b>Election Cycles</b></span><br/>
      <label for="fromYear">From</label>
      <select [(ngModel)]="fromYear" (change)="onFromElectionYearsChange()">
        <option *ngFor="let year of electionYears" [value]="year">{{year}}</option>
      </select>
      <label for="toYear">To</label>
      <select [(ngModel)]="toYear">
        <option *ngFor="let year of toElectionYears()" [value]="year">{{year}}</option>
      </select>
    </div>
  </div>
  <div class="row">
    <div class="col-5">
      <button (click)="clearForm()">Clear Form</button>
    </div>
    <div class="col">
      <!--this column left intentionally blank-->
    </div>
    <div class="col">
      <button (click)="submit()">Submit</button>
    </div>
  </div>
</div>

<p *ngIf="loading">loading...</p>
<p *ngIf="!loading && data && data.length <= 0">No results</p>
<div class="alert alert-danger" role="alert" *ngIf="!loading && pagination && pagination.count > 2000">Limit Exceeded!
  Search returned {{pagination.count}} contributions. Processed only first 2000 results.</div>
<div class="alert alert-info" role="alert" *ngIf="!loading && pagination && pagination.count <= 2000">Processed
  {{pagination.count}} contributions.</div>
<div *ngFor="let cycleMapEntity of cycleMap | keyvalue">
  <h3>{{cycleMapEntity.key}} Election Cycle</h3>
  <app-bar-chart label="Total Contributions in Dollars" [chartData]="chartMap.get(cycleMapEntity.key)"></app-bar-chart>
  <div class="party" [style.background-color]="getColor(partyMapEntity.key)"
    *ngFor="let partyMapEntity of cycleMap.get(cycleMapEntity.key) | keyvalue">
    <h3>{{partyMapEntity.key}}</h3><br />
    <div *ngFor="let committeeMapEntity of cycleMap.get(cycleMapEntity.key).get(partyMapEntity.key) | keyvalue">
      <p>Committee: {{committeeMapEntity.key}}&nbsp;&nbsp;
        <a title="FEC Committee Page"
          href="https://www.fec.gov/data/committee/{{getCommitteeId(committeeMapEntity.key)}}/"><img class="icon"
            src="../assets/icons/fec.png"></a>&nbsp;&nbsp;
        <a title="Open Secrets Committee Page"
          href="https://www.opensecrets.org/pacs/lookup2.php?strID={{getCommitteeId(committeeMapEntity.key)}}"><img
            class="icon" src="../assets/icons/opensecrets.ico"></a>&nbsp;&nbsp;
      </p>
      <app-contribution-table
        [contributions]="getContributions(cycleMapEntity.key, partyMapEntity.key, committeeMapEntity.key)">
      </app-contribution-table>
    </div>
  </div>
</div>